<?xml version="1.0"?>
<ruleset name="AtlasPress">
    <description>AtlasPress WordPress Plugin</description>
    
    <!-- Exclude files -->
    <exclude-pattern>*/node_modules/*</exclude-pattern>
    <exclude-pattern>*/vendor/*</exclude-pattern>
    
    <!-- WordPress minimum version -->
    <config name="wp_version" value="5.6"/>
    
    <!-- Set standard -->
    <rule ref="WordPress">
        <!-- Exclude warnings that are acceptable for this plugin type -->
        
        <!-- Nonce verification - using admin pages, not forms -->
        <exclude name="WordPress.Security.NonceVerification.Recommended"/>
        <exclude name="WordPress.Security.NonceVerification.Missing"/>
        
        <!-- Direct database calls - standard for custom plugins -->
        <exclude name="WordPress.DB.DirectDatabaseQuery.DirectQuery"/>
        <exclude name="WordPress.DB.DirectDatabaseQuery.NoCaching"/>
        <exclude name="WordPress.DB.DirectDatabaseQuery.SchemaChange"/>
        
        <!-- Prepared SQL warnings - table names are safely constructed -->
        <exclude name="WordPress.DB.PreparedSQL.InterpolatedNotPrepared"/>
        <exclude name="WordPress.DB.PreparedSQLPlaceholders.UnfinishedPrepare"/>
        <exclude name="WordPress.DB.PreparedSQLPlaceholders.ReplacementsWrongNumber"/>
        
        <!-- Security warnings for intentional patterns -->
        <exclude name="WordPress.Security.ValidatedSanitizedInput.MissingUnslash"/>
        <exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotSanitized"/>
        <exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotValidated"/>
        
        <!-- Slow query warning -->
        <exclude name="WordPress.DB.SlowDBQuery.slow_db_query_meta_key"/>
        
        <!-- Plugin check security warnings -->
        <exclude name="PluginCheck.Security.DirectDB.UnescapedDBParameter"/>
        
        <!-- Development functions -->
        <exclude name="WordPress.PHP.DevelopmentFunctions.error_log_error_log"/>
    </rule>
</ruleset>
